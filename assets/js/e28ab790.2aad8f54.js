"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2914],{19991:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>f,frontMatter:()=>r,metadata:()=>d,toc:()=>a});var i=o(85893),t=o(11151);const r={},s="Configuration",d={id:"development/Configuration-Storage",title:"Configuration",description:"The configuration in cleanflight is stored at the end of the flash ram, currently it uses 2-4KB of flash depending on the target.",source:"@site/docs/development/Configuration-Storage.md",sourceDirName:"development",slug:"/development/Configuration-Storage",permalink:"/docs/development/Configuration-Storage",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"development",previous:{title:"Configuration Format",permalink:"/docs/development/Configuration-Format"},next:{title:"Configuration",permalink:"/docs/development/Configuration"}},c={},a=[{value:"Erasing",id:"erasing",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,t.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(e.p,{children:"The configuration in cleanflight is stored at the end of the flash ram, currently it uses 2-4KB of flash depending on the target."}),"\n",(0,i.jsx)(e.p,{children:"Sometimes it's necessary to erase this during development."}),"\n",(0,i.jsx)(e.h2,{id:"erasing",children:"Erasing"}),"\n",(0,i.jsx)(e.p,{children:"Generate a 2-4kb blank file."}),"\n",(0,i.jsx)(e.p,{children:"2kb:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"dd if=/dev/zero of=obj/blankconfig.bin bs=1024 count=2\n"})}),"\n",(0,i.jsx)(e.p,{children:"4kb:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"dd if=/dev/zero of=obj/blankconfig.bin bs=1024 count=4\n"})}),"\n",(0,i.jsx)(e.p,{children:"Overwrite configuration using JLink"}),"\n",(0,i.jsxs)(e.p,{children:["Run JLink (OSX: ",(0,i.jsx)(e.code,{children:"/Applications/SEGGER/JLink/JLinkExe"}),")"]}),"\n",(0,i.jsxs)(e.p,{children:["Execute commands\n",(0,i.jsx)(e.code,{children:"device <your device>"}),", e.g. ",(0,i.jsx)(e.code,{children:"STM32F303CB"}),"\n",(0,i.jsx)(e.code,{children:"r"}),"\n",(0,i.jsx)(e.code,{children:"h"}),"\n",(0,i.jsx)(e.code,{children:"loadbin obj/blankconfig.bin, <address>"}),"\n",(0,i.jsx)(e.code,{children:"r"})," to Reboot FC.\n",(0,i.jsx)(e.code,{children:"q"})," to quit"]}),"\n",(0,i.jsx)(e.p,{children:"the address is the address of the end of the flash ram minus the size of the configuration."}),"\n",(0,i.jsx)(e.p,{children:"example addresses:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"64k device/2kb config = 0x800F800\n128k device/2kb config = 0x801F800\n128k device/4kb config = 0x801F000\n256k device/2kb config = 0x803f800\n256k device/4kb config = 0x803f000\n"})}),"\n",(0,i.jsx)(e.p,{children:"Example session"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"$ /Applications/SEGGER/JLink/JLinkExe\nSEGGER J-Link Commander V4.90c ('?' for help)\nCompiled Aug 29 2014 09:52:38\nDLL version V4.90c, compiled Aug 29 2014 09:52:33\nFirmware: J-Link ARM-OB STM32 compiled Aug 22 2012 19:52:04\nHardware: V7.00\nS/N: -1\nFeature(s): RDI,FlashDL,FlashBP,JFlash,GDBFull\nVTarget = 3.300V\nInfo: Could not measure total IR len. TDO is constant high.\nInfo: Could not measure total IR len. TDO is constant high.\nNo devices found on JTAG chain. Trying to find device on SWD.\nInfo: Found SWD-DP with ID 0x2BA01477\nInfo: Found Cortex-M4 r0p1, Little endian.\nInfo: FPUnit: 6 code (BP) slots and 2 literal slots\nInfo: TPIU fitted.\nInfo: ETM fitted.\nCortex-M4 identified.\nTarget interface speed: 100 kHz\nJ-Link>device STM32F303CC\nInfo: Device \"STM32F303CC\" selected (256 KB flash, 32 KB RAM).\nReconnecting to target...\nInfo: Found SWD-DP with ID 0x2BA01477\nInfo: Found SWD-DP with ID 0x2BA01477\nInfo: Found Cortex-M4 r0p1, Little endian.\nInfo: FPUnit: 6 code (BP) slots and 2 literal slots\nInfo: TPIU fitted.\nInfo: ETM fitted.\nJ-Link>r\nReset delay: 0 ms\nReset type NORMAL: Resets core & peripherals via SYSRESETREQ & VECTRESET bit.\nJ-Link>h\nPC = 08001154, CycleCnt = 00000000\nR0 = 00000000, R1 = 00000000, R2 = 00000000, R3 = 00000000\nR4 = 00000000, R5 = 00000000, R6 = 00000000, R7 = 00000000\nR8 = 00000000, R9 = 00000000, R10= 00000000, R11= 00000000\nR12= 00000000\nSP(R13)= 2000A000, MSP= 2000A000, PSP= 00000000, R14(LR) = FFFFFFFF\nXPSR = 01000000: APSR = nzcvq, EPSR = 01000000, IPSR = 000 (NoException)\nCFBP = 00000000, CONTROL = 00, FAULTMASK = 00, BASEPRI = 00, PRIMASK = 00\nFPU regs: FPU not enabled / not implemented on connected CPU.\nJ-Link>loadbin obj/blankconfig.bin, 0x803f800\nDownloading file [obj/blankconfig.bin]...\nWARNING: CPU is running at low speed (7989 kHz).\nInfo: J-Link: Flash download: Flash programming performed for 1 range (2048 bytes)\nInfo: J-Link: Flash download: Total time needed: 1.254s (Prepare: 0.698s, Compare: 0.009s, Erase: 0.075s, Program: 0.405s, Verify: 0.005s, Restore: 0.059s)\nO.K.\nJ-Link>r\nReset delay: 0 ms\nReset type NORMAL: Resets core & peripherals via SYSRESETREQ & VECTRESET bit.\nJ-Link>q\n"})})]})}function f(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},11151:(n,e,o)=>{o.d(e,{Z:()=>d,a:()=>s});var i=o(67294);const t={},r=i.createContext(t);function s(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);