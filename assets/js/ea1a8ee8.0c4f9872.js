"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5513],{88539:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>d,frontMatter:()=>h,metadata:()=>n,toc:()=>o});var l=i(85893),a=i(11151);const h={sidebar_position:5},r="Betaflight 4.0 Release Notes",n={id:"wiki/release/Betaflight-4-0-Release-Notes",title:"Betaflight 4.0 Release Notes",description:"It took us a long time, but now it\u2019s here, and it\u2019s got so many new things!",source:"@site/docs/wiki/release/Betaflight-4-0-Release-Notes.md",sourceDirName:"wiki/release",slug:"/wiki/release/Betaflight-4-0-Release-Notes",permalink:"/docs/wiki/release/Betaflight-4-0-Release-Notes",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"wiki",previous:{title:"Betaflight 4.1 Release Notes",permalink:"/docs/wiki/release/Betaflight-4-1-Release-Notes"},next:{title:"Betaflight 3.5 Release Notes",permalink:"/docs/wiki/release/Betaflight-3-5-Release-Notes"}},s={},o=[{value:"Important information when upgrading",id:"important-information-when-upgrading",level:2},{value:"Major features:",id:"major-features",level:2},{value:"Minor features:",id:"minor-features",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.h1,{id:"betaflight-40-release-notes",children:"Betaflight 4.0 Release Notes"}),"\n",(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"It took us a long time, but now it\u2019s here, and it\u2019s got so many new things!"})}),"\n",(0,l.jsx)(t.p,{children:"When we released 3.5 in August last year, the number of different targets supported by Betaflight had reached 150, and maintaining them was becoming a major effort and taking up a lot of our time. It became clear that we had to do something. We had been working on changing the architecture of Betaflight to make it possible to use the same firmware for different flight controllers for some time, and so we decided to complete this change before releasing the next version, and that because of this fundamental change the next version would be 4.0."}),"\n",(0,l.jsx)(t.p,{children:"As we approached the originally set release date for Betaflight 4.0, we realised that we were not quite ready, and we decided to take another three months, in order to be able to complete the work we had started."}),"\n",(0,l.jsx)(t.p,{children:"So now, here we are, \u2018Unified Targets\u2019, as we called the new \u2018one firmware for many flight controllers\u2019 technology, is now a reality in Betaflight 4.0. There is still some work left to be done to add support for flashing Unified Targets with their configurations to Betaflight configurator, but once this is done, we will be able to allow manufacturers to make firmware for any number of boards, or RTF products, available directly in configurator."}),"\n",(0,l.jsx)(t.p,{children:"As you have come to expect from Betaflight, we have picked up a number of new and exciting improvements to the flight performance, like ESC RPM based filtering, D term management with D_min, and throttle based dynamic gyro and D term filtering."}),"\n",(0,l.jsx)(t.p,{children:"And, again as expected we have added some more, non flight related new features like launch control, OSD profiles, and support for on-board SPI attached RX."}),"\n",(0,l.jsx)(t.p,{children:"For an extended list of new features see below."}),"\n",(0,l.jsxs)(t.p,{children:["To get the best out of the flight performance improvements, please read these ",(0,l.jsx)(t.a,{href:"/docs/wiki/tuning/4-0-Tuning-Notes",children:"tuning tips"}),"."]}),"\n",(0,l.jsx)(t.p,{children:"If you are upgrading from an earlier version of Betaflight, please read the following section containing a list of things that you might have to change in your configuration."}),"\n",(0,l.jsxs)(t.p,{children:["We have tried to make this release as bug free as possible. If you still find a ",(0,l.jsx)(t.strong,{children:"bug"}),", please report it back to us by opening an ",(0,l.jsxs)(t.strong,{children:["issue ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/issues",children:"here"})]}),"."]}),"\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.em,{children:"Kia kaha"})," (stay strong)"]}),"\n",(0,l.jsx)(t.h2,{id:"important-information-when-upgrading",children:"Important information when upgrading"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["A number of changes and improvements in this release require changes to the Betaflight configurator. These changes have been added to ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight-configurator/releases/tag/10.5.1",children:"Betaflight configurator 10.5.1"})," (installation instructions ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight-configurator#installation",children:"here"}),"), please update your Betaflight configurator to at least this version;"]}),"\n",(0,l.jsxs)(t.li,{children:["if you are using the Blackbox Log Viewer, there is an updated ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/blackbox-log-viewer/releases/tag/3.3.1",children:"version 3.3.1"})," to go with Betaflight 4.0 (installation instructions ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/blackbox-log-viewer#installation",children:"here"}),"). Please update to at least this version;"]}),"\n",(0,l.jsxs)(t.li,{children:["if you are using OpenTX and the Betaflight TX Lua scripts, please update them to at least ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight-tx-lua-scripts/releases/tag/1.2.0",children:"version 1.2.0"})," in order to get support for the latest features introduced in Betaflight 4.0;"]}),"\n",(0,l.jsxs)(t.li,{children:["there are a number of flight performance related improvements in Betaflight 4.0. Therefore, ",(0,l.jsx)(t.strong,{children:"pasting back-ups of the tuning settings for older versions of Betaflight into Betaflight 4.0 will most likely result in poor flight performance"}),"! The default settings in Betaflight 4.0 should be reasonably well flyable for most hardware configurations, but users wanting to tune the performance of their craft should read the ",(0,l.jsx)(t.a,{href:"/docs/wiki/tuning/4-0-Tuning-Notes",children:"4.0 Tuning Notes"})," to learn everything they need to know about tuning Betaflight 4.0 (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6432",children:"#6432"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6943",children:"#6943"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7078",children:"#7078"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7264",children:"#7264"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7271",children:"#7271"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7304",children:"#7304"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7373",children:"#7373"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7538",children:"#7538"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["there was a fix to how the ",(0,l.jsx)(t.code,{children:"min_check"})," 'zero throttle' dead zone is applied. Before the fix, there was an additional, undocumented deadband of the same size as the ",(0,l.jsx)(t.code,{children:"min_check"})," range above the ",(0,l.jsx)(t.code,{children:"min_check"})," range. The fix has not brought a change to the arming behaviour and throttle is still required to be below ",(0,l.jsx)(t.code,{children:"min_check"})," for arming to be possible. However the extra unintended throttle deadband above ",(0,l.jsx)(t.code,{children:"min_check"})," has been eliminated. This will result in more responsive throttle near minimum and a slight increase in throttle resolution. If you desire to retain the same range for the 'zero throttle' dead zone, you need to double the amount of dead zone configured in ",(0,l.jsx)(t.code,{children:"min_check"})," (offset from 1000). Be aware that this will also double the throttle range within which the craft can be armed (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7463",children:"#7463"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["there is a new 'Stick Overlay' OSD element that shows an overlay of the current stick positions. In order to use it, the font loaded onto the OSD needs to be updated to the latest version (available in configurator 10.5.0 or newer) (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7476",children:"#7476"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["the functionality of the 'crash flip arrow' OSD element was extended to activate as well when the craft is not in crash flip mode, but ",(0,l.jsx)(t.code,{children:"small_angle"})," is set, and the craft is unarmed and tilted more than ",(0,l.jsx)(t.code,{children:"small_angle"}),". This is to show pilots that they won't be able to arm from the current orientation, and allow them to activate crash flip mode and then right their craft (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7250",children:"#7250"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["As part of the introduction of Unified Targets, the existing ",(0,l.jsx)(t.code,{children:"resource"})," command was complemented with two new commands for resource management: ",(0,l.jsx)(t.code,{children:"timer"})," and ",(0,l.jsx)(t.code,{children:"dma"}),". Just like ",(0,l.jsx)(t.code,{children:"resource"})," can be used to assign pins to functions, ",(0,l.jsx)(t.code,{children:"timer"})," can be used to assign timers to pins, and ",(0,l.jsx)(t.code,{children:"dma"})," can be used to assign DMA streams to subsystems and pins (if they have a timer assigned). ",(0,l.jsx)(t.strong,{children:"Important:"})," Since DMA streams are linked to pins through timers, ",(0,l.jsx)(t.code,{children:"timer"})," assignments for pins have to be made first, before ",(0,l.jsx)(t.code,{children:"dma"})," assignments to these pins can be made (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/5824",children:"#5824"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6837",children:"#6837"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7620",children:"#7620"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["The syntax for the ",(0,l.jsx)(t.code,{children:"resource"}),", ",(0,l.jsx)(t.code,{children:"timer"}),", and ",(0,l.jsx)(t.code,{children:"dma"})," commands was consolidated, and as part of this the ",(0,l.jsx)(t.code,{children:"resource list"})," subcommand was renamed into ",(0,l.jsx)(t.code,{children:"resource show"}),". This aligns it with the new ",(0,l.jsx)(t.code,{children:"dma show"})," and ",(0,l.jsx)(t.code,{children:"timer show"})," subcommands (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7712",children:"#7712"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["the following parameters were renamed to more closely match their function: ",(0,l.jsx)(t.code,{children:"p_level"})," => ",(0,l.jsx)(t.code,{children:"angle_level_strength"}),", ",(0,l.jsx)(t.code,{children:"i_level"})," => ",(0,l.jsx)(t.code,{children:"horizon_level_strength"}),", ",(0,l.jsx)(t.code,{children:"d_level"})," => ",(0,l.jsx)(t.code,{children:"horizon_transition"})," (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6673",children:"#6673"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["the gyro configuration was unified from being done by gyro hardware model to being generic for all gyro models. This means that for some targets that are used for multiple different boards that come with different gyro models ",(0,l.jsx)(t.em,{children:"that are mounted with different orientations"}),", it is necessary from Betaflight 4.0 on to manually set ",(0,l.jsx)(t.code,{children:"gyro_1_sensor_align"})," (and / or ",(0,l.jsx)(t.code,{children:"gyro_2_sensor_align"})," for boards with a second gyro) to match the gyro orientation on the board that is used. See note ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6761",children:"#6761"})," for an explanation, and instructions for individual boards. This is a temporary workaround, per-board configurations with correct gyro alignment will be released as Unified Target configurations (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/5868",children:"#5868"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["unfortunately, bugfixes in the flight controller core functionality have led to an increase of the firmware size, causing it to overflow the available space on almost all F3 based flight controllers. As a result, features have had to be removed from all but a few of the currently supported F3 based flight controllers. Some of the affected targets are: AIORACERF3, BETAFLIGHTF3, CHEBUZZF3, CRAZYBEEF3FR, FURYF3, FURYF3OSD, IMPULSERCF3, LUX_RACE, LUXV2_RACE, MIDELICF3, OMNIBUS, RACEBASE, RMDO, SIRINFPV, SPRACINGF3, SPRACINGF3MINI, SPRACINGF3NEO, STM32F3DISCOVERY (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6900",children:"#6900"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6955",children:"#6955"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7037",children:"#7037"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7038",children:"#7038"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7045",children:"#7045"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7306",children:"#7306"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7381",children:"#7381"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7392",children:"#7392"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7402",children:"#7402"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7421",children:"#7421"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7501",children:"#7501"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7508",children:"#7508"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7518",children:"#7518"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7829",children:"#7829"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7842",children:"#7842"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["in addition to the above point, the following features had to be removed from all F3 based flight controllers in order to make the firmware fit into flash: Smart Feedforward, support for flashing / configuration of SimonK based ESCs (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7272",children:"#7272"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7274",children:"#7274"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7391",children:"#7391"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["support for status display through LED strips was removed from F3 based flight controllers, in order to be able to reclaim some flash space. In its place, ",(0,l.jsx)(t.a,{href:"/docs/development/LedStrip#led-strip-profiles",children:"LED Strip Profiles"})," (except for the 'Status' profile which is not supported on F3) can be used to set LED strips to fixed colours. LED strip profiles are also available on F4 / F7, to enable simple configuration of the LED strip in OSD (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7485",children:"#7485"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["since the above three measures proved to be insufficient to keep flash space from overflowing on F3 based flight controllers, a system of classifying F3 based flight controllers into a number of 'feature cut' levels, and removing features according from them according to their level were introduced. This was used to reduce the number of features built into most F3 based flight controllers even more (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7429",children:"#7429"}),")."]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"major-features",children:"Major features:"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["real time ESC RPM feedback, and notch filtering based on motor RPM (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7264",children:"#7264"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7271",children:"#7271"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["D term management with D_min (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7373",children:"#7373"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7538",children:"#7538"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["throttle based dynamic gyro and D term filtering (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6943",children:"#6943"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["launch control (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6992",children:"#6992"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["switchable OSD profiles (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6714",children:"#6714"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["SPI attached Spektrum RX (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7210",children:"#7210"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["Unified Targets (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/5824",children:"#5824"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6837",children:"#6837"}),", ",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7620",children:"#7620"}),")."]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"minor-features",children:"Minor features:"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["cascaded dynamic notches (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7078",children:"#7078"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["thrust linearisation (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7304",children:"#7304"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["integrated yaw control (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6432",children:"#6432"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["switchable LED_STRIP profiles (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7303",children:"#7303"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["stick overlays in OSD (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7167",children:"#7167"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["profile switching based on battery cell count (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7516",children:"#7516"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["per profile limiting of maximum motor output (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7482",children:"#7482"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["support for the Futaba SFHSS protocol on CC2500 (FrSky SPI) hardware (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6865",children:"#6865"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["EU LBT mode for the FrSky SPI RX (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/7339",children:"#7339"}),");"]}),"\n",(0,l.jsxs)(t.li,{children:["support for STM32F765xx based flight controllers (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6669",children:"#6669"}),")."]}),"\n",(0,l.jsxs)(t.li,{children:["configuration over HoTT telemetry (",(0,l.jsx)(t.a,{href:"https://github.com/betaflight/betaflight/pull/6224",children:"#6224"}),")."]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},11151:(e,t,i)=>{i.d(t,{Z:()=>n,a:()=>r});var l=i(67294);const a={},h=l.createContext(a);function r(e){const t=l.useContext(h);return l.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function n(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),l.createElement(h.Provider,{value:t},e.children)}}}]);