"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8581],{72232:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>h,contentTitle:()=>i,default:()=>j,frontMatter:()=>n,metadata:()=>l,toc:()=>c});var d=t(85893),r=t(11151);const n={},i="KIWI F4 V2",l={id:"wiki/boards/KIWIF4V2",title:"KIWI F4 V2",description:"Flight Controller",source:"@site/docs/wiki/boards/KIWIF4V2.md",sourceDirName:"wiki/boards",slug:"/wiki/boards/KIWIF4V2",permalink:"/docs/wiki/boards/KIWIF4V2",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"wiki",previous:{title:"KIWI F4",permalink:"/docs/wiki/boards/KIWIF4"},next:{title:"KROOZX",permalink:"/docs/wiki/boards/KROOZX"}},h={},c=[{value:"Description",id:"description",level:2},{value:"MCU, Sensors and Features",id:"mcu-sensors-and-features",level:2},{value:"Hardware",id:"hardware",level:3},{value:"Manufacturers and Distributors",id:"manufacturers-and-distributors",level:2},{value:"Contributors",id:"contributors",level:2},{value:"Variants",id:"variants",level:2},{value:"FAQ &amp; Known Issues",id:"faq--known-issues",level:2},{value:"Troubles Entering Bootloader Mode (DFU):",id:"troubles-entering-bootloader-mode-dfu",level:3},{value:"Voltage and Current Scaling:",id:"voltage-and-current-scaling",level:3},{value:"Resource mapping",id:"resource-mapping",level:2},{value:"SPI3 (MAX7456)",id:"spi3-max7456",level:3},{value:"I2C (Disabled by Default)",id:"i2c-disabled-by-default",level:3},{value:"Other Resources",id:"other-resources",level:2},{value:"Enable Camera Control:",id:"enable-camera-control",level:3}];function x(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.h1,{id:"kiwi-f4-v2",children:"KIWI F4 V2"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{src:"http://i.imgur.com/1XKRUdq.jpg",alt:"Flight Controller"})}),"\n",(0,d.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,d.jsx)(s.p,{children:"MPU-6000 F4 flight controller with stackable PDB. Integrated 12V and 5V regulators. Built-in OSD, S.Port inverter, SD Card slot."}),"\n",(0,d.jsx)(s.h2,{id:"mcu-sensors-and-features",children:"MCU, Sensors and Features"}),"\n",(0,d.jsx)(s.h3,{id:"hardware",children:"Hardware"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Hardware"}),(0,d.jsx)(s.th,{children:"Part Number"}),(0,d.jsx)(s.th,{children:"Notes"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"MCU"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.a,{href:"http://www.mouser.com/ds/2/389/DM00037051-492832.pdf",children:"STM32F405RGT6"})}),(0,d.jsx)(s.td,{children:"4 Hardware UARTS - Shared PPM/UART TBD"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"IMU"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.a,{href:"https://store.invensense.com/datasheets/invensense/MPU-6050_DataSheet_V3%204.pdf",children:"MPU-6000"})}),(0,d.jsx)(s.td,{children:"Interrupt TBD"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"OSD"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.a,{href:"https://datasheets.maximintegrated.com/en/ds/MAX7456.pdf",children:"MAX 7456"})}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"12V Regulator"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.a,{href:"https://www.onsemi.com/pub/Collateral/NCP1117-D.PDF",children:"NCP1117 17-12G"})}),(0,d.jsx)(s.td,{children:"LDO Linear: 1A Max"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"5V Regulator"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.a,{href:"http://www.ti.com/lit/ds/symlink/lmr14206.pdf",children:"LMR14206"})}),(0,d.jsx)(s.td,{children:"Switching Freq: 1.25MHz"})]})]})]}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Features"}),(0,d.jsx)(s.th,{children:"Yes/No"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Barometer"}),(0,d.jsx)(s.td,{children:"No"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"VCP"}),(0,d.jsx)(s.td,{children:"Yes"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"OSD"}),(0,d.jsx)(s.td,{children:"Yes"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SD Card"}),(0,d.jsx)(s.td,{children:"Yes"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Voltage Sensor"}),(0,d.jsx)(s.td,{children:"Yes"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Current Sensor"}),(0,d.jsx)(s.td,{children:"Yes"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Boot Button"}),(0,d.jsx)(s.td,{children:"Yes"})]})]})]}),"\n",(0,d.jsx)(s.h2,{id:"manufacturers-and-distributors",children:"Manufacturers and Distributors"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://flyinglemon.eu/flight-controllers/39-kiwif4-flight-controller.html",children:"Flying Lemon"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://beaverfpv.com/collections/new-arrivals/products/kiwi-f4-flight-controller-kiwi-pdb",children:"Beaver FPV"})}),"\n",(0,d.jsx)(s.h2,{id:"contributors",children:"Contributors"}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.a,{href:"https://github.com/flyinglemonfpv",children:"FlyingLemonFPV"})," - Board Designer\n",(0,d.jsx)(s.a,{href:"https://github.com/MiddleMan5",children:"MiddleMan5"})," - Documentation"]}),"\n",(0,d.jsx)(s.h2,{id:"variants",children:"Variants"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"KIWIF4",children:"Kiwi F4"})}),"\n",(0,d.jsx)(s.p,{children:"V2 improved upon the Kiwi F4 by adding an SD Card slot, moving the IMU closer to the center of the board, and changing the through hole solder points to pads."}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"PLUMF4",children:"Plum F4"})}),"\n",(0,d.jsx)(s.p,{children:"A cheaper variant of the Kiwi F4 V2 that removes the PDB socket, the OSD, and the video line filters."}),"\n",(0,d.jsx)(s.h2,{id:"faq--known-issues",children:"FAQ & Known Issues"}),"\n",(0,d.jsx)(s.h3,{id:"troubles-entering-bootloader-mode-dfu",children:"Troubles Entering Bootloader Mode (DFU):"}),"\n",(0,d.jsx)(s.p,{children:'Some devices (e.g. receivers connected to SBUS/IBUS port or devices connected to one of the UARTS) can inhibit the FC from entering USB bootloader mode. In this case the FC will not be detected by Windows/MacOS. Windows detects the FC as "Unknown Device", MacOS reports "enumeration errors". If you see some of these errors unplug all devices from the FC and flash the FC standalone.'}),"\n",(0,d.jsx)(s.h3,{id:"voltage-and-current-scaling",children:"Voltage and Current Scaling:"}),"\n",(0,d.jsx)(s.p,{children:"Flying Lemon said to use the following for scale:\nvoltage 57, current 444 offset 11."}),"\n",(0,d.jsx)(s.h2,{id:"resource-mapping",children:"Resource mapping"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"BF 3.2.5"})}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Label"}),(0,d.jsx)(s.th,{children:"Pin"}),(0,d.jsx)(s.th,{children:"Timer"}),(0,d.jsx)(s.th,{children:"DMA"}),(0,d.jsx)(s.th,{children:"Default"}),(0,d.jsx)(s.th,{children:"Note"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"LED0_PIN"}),(0,d.jsx)(s.td,{children:"PB4"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"BEEPER"}),(0,d.jsx)(s.td,{children:"PA8"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"INVERTER_PIN_UART1"}),(0,d.jsx)(s.td,{children:"PC0"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"MPU6000_INT_EXTI"}),(0,d.jsx)(s.td,{children:"PC4"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"MPU6000_CS_PIN"}),(0,d.jsx)(s.td,{children:"PA4"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"MAX7456_SPI_CS_PIN"}),(0,d.jsx)(s.td,{children:"PA15"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SDCARD_DETECT_PIN"}),(0,d.jsx)(s.td,{children:"PB9"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SDCARD_SPI_CS_PIN"}),(0,d.jsx)(s.td,{children:"PB12"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"VBUS_SENSING_PIN"}),(0,d.jsx)(s.td,{children:"PC5"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART1 TX"}),(0,d.jsx)(s.td,{children:"PA9"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART1 RX"}),(0,d.jsx)(s.td,{children:"PA10"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART3 TX"}),(0,d.jsx)(s.td,{children:"PB10"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART3 RX"}),(0,d.jsx)(s.td,{children:"PB11"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART6 TX"}),(0,d.jsx)(s.td,{children:"PC6"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"UART6 RX"}),(0,d.jsx)(s.td,{children:"PC7"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"VBAT_ADC_PIN"}),(0,d.jsx)(s.td,{children:"PC1"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"RSSI_ADC_PIN"}),(0,d.jsx)(s.td,{children:"PC2"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"CURRENT_METER_ADC_PIN"}),(0,d.jsx)(s.td,{children:"PC3"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]})]})]}),"\n",(0,d.jsx)(s.h3,{id:"spi3-max7456",children:"SPI3 (MAX7456)"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Label"}),(0,d.jsx)(s.th,{children:"Pin"}),(0,d.jsx)(s.th,{children:"Timer"}),(0,d.jsx)(s.th,{children:"DMA"}),(0,d.jsx)(s.th,{children:"Default"}),(0,d.jsx)(s.th,{children:"Note"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SPI3_NSS_PIN"}),(0,d.jsx)(s.td,{children:"PA15"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SPI3_SCK_PIN"}),(0,d.jsx)(s.td,{children:"PC10"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SPI3_MISO_PIN"}),(0,d.jsx)(s.td,{children:"PC11"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"SPI3_MOSI_PIN"}),(0,d.jsx)(s.td,{children:"PC12"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]})]})]}),"\n",(0,d.jsx)(s.h3,{id:"i2c-disabled-by-default",children:"I2C (Disabled by Default)"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Label"}),(0,d.jsx)(s.th,{children:"Pin"}),(0,d.jsx)(s.th,{children:"Timer"}),(0,d.jsx)(s.th,{children:"DMA"}),(0,d.jsx)(s.th,{children:"Default"}),(0,d.jsx)(s.th,{children:"Note"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"I2C_C1_SCL"}),(0,d.jsx)(s.td,{children:"PB6"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"I2C_C1_SDA"}),(0,d.jsx)(s.td,{children:"PB7"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]})]})]}),"\n",(0,d.jsx)(s.h2,{id:"other-resources",children:"Other Resources"}),"\n",(0,d.jsx)(s.h3,{id:"enable-camera-control",children:"Enable Camera Control:"}),"\n",(0,d.jsxs)(s.ol,{children:["\n",(0,d.jsxs)(s.li,{children:["See ",(0,d.jsx)(s.a,{href:"/docs/wiki/guides/current/FPV-Camera-Control-Joystick-Emulation",children:"this page"})," for setting up your camera."]}),"\n",(0,d.jsx)(s.li,{children:"After configuring your hardware (RC Filter) solder your OSD control wire to the VTX.CLK pad (PIN B06)."}),"\n",(0,d.jsx)(s.li,{children:"Enter the following commands:"}),"\n"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"resource CAMERA_CONTROL 1 B06\nset camera_control_mode = software_pwm\nset camera_control_ref_voltage = 330\nset camera_control_key_delay = 180\nset camera_control_internal_resistance = 470\nsave\n"})}),"\n",(0,d.jsxs)(s.p,{children:["You may have to set your reference voltage, key_delay, and/or internal resistance depending on your camera.\nFor me ( ",(0,d.jsx)(s.a,{href:"https://github.com/MiddleMan5",children:"MiddleMan5"})," ), I soldered a 1uF capacitor between OSD and ground directly on my Foxeer Monster V2 and added an inline resistor of 220 ohms to the OSD pad (VTX.CLK). My reference voltage and key delay were the same as listed above, my internal resistance was set to 107."]}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.strong,{children:"NOTE"})," the above configuration worked for me, it is not guaranteed to work for you, and you may have to play around with the configuration. The software PWM on VTX.CLK is probably not the best method either, but it does function perfectly well for my setup."]}),"\n",(0,d.jsx)(s.p,{children:"###Setup Guide:"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{src:"https://i.imgur.com/WmDlIHV.jpg",alt:"Wiring Diagram"})}),"\n",(0,d.jsx)(s.p,{children:"Dimensions:\nFC: 36mm x 36mm x 6.8mm(H)"})]})}function j(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(x,{...e})}):x(e)}},11151:(e,s,t)=>{t.d(s,{Z:()=>l,a:()=>i});var d=t(67294);const r={},n=d.createContext(r);function i(e){const s=d.useContext(n);return d.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),d.createElement(n.Provider,{value:s},e.children)}}}]);